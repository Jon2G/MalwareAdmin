using AsyncAwaitBestPractices.MVVM;
using Kit.Extensions;
using Kit.Model;

namespace MalwareAdmin.ViewModels
{
    public class FileContextMenuViewModel : ModelBase
    {
        public Command<FileObject> DeleteCommand { get; set; }
        public Command<ZipFileObject> UnCompressCommand { get; set; }
        public Command<FileObject> ShowInExplorerCommand { get; set; }
        public Command<FileObject> ShowInViperCommand { get; set; }
        public AsyncCommand<FileObject> DownloadFromVTCommand { get; set; }
        private FileObject _File;
        public FileObject File
        {
            get => _File;
            set
            {
                RaiseIfChanged(ref _File, value);
                Raise(() => IsZip);
            }
        }

        public bool IsZip => File is ZipFileObject;
        public FileContextMenuViewModel(FileObject file = null)
        {
            File = file;
            DeleteCommand = new Command<FileObject>(Delete);
            UnCompressCommand = new Command<ZipFileObject>(UnCompress);
            ShowInExplorerCommand = new Command<FileObject>(ShowInExplorer);
            DownloadFromVTCommand = new AsyncCommand<FileObject>(DownloadFromVT);
            ShowInViperCommand = new Command<FileObject>(ShowInViper);
        }


        private void ShowInExplorer(FileObject file)
        {
            file.Parent.ShowInExplorer();
        }
        private void UnCompress(ZipFileObject file)
        {
            file.UnCompress();
        }
        private void Delete(FileObject file)
        {
            file?.Delete();
        }

    }
}
