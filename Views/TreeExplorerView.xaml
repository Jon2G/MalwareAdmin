<controls:ObservableUserControl x:Class="MalwareAdmin.Views.TreeExplorerView"
                       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                       xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                       xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                       xmlns:local="clr-namespace:MalwareAdmin.Views"
                       xmlns:files="clr-namespace:MalwareAdmin.Models.Files"
                       xmlns:controls="clr-namespace:Kit.WPF.Controls;assembly=Kit.WPF"
                       mc:Ignorable="d" x:Name="View"
                       xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
                       xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
                       xmlns:fa5="http://schemas.fontawesome.com/icons/"
                       xmlns:contextMenus="clr-namespace:MalwareAdmin.Views.ContextMenus"
                       d:DesignHeight="450" d:DesignWidth="800">
    <TreeView ItemsSource="{Binding ExplorerItems,ElementName=View}" Padding="0" Margin="0"
              Width="Auto" HorizontalContentAlignment="Stretch" SelectedItemChanged="TreeView_OnSelectedItemChanged"
              KeyUp="UIElement_OnKeyUp" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
        <TreeView.Resources>
            <Style TargetType="TreeViewItem" BasedOn="{StaticResource MaterialDesignTreeViewItem}">
                <Setter Property="materialDesign:TreeViewAssist.ExpanderSize" Value="32"/>
                <Setter Property="materialDesign:TreeViewAssist.ShowSelection" Value="False"/>
            </Style>
            <HierarchicalDataTemplate 
                DataType="{x:Type files:FolderObject}"
                ItemsSource="{Binding Items}">
                <StackPanel HorizontalAlignment="Stretch">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="MouseLeftButtonUp">
                            <i:InvokeCommandAction Command="{Binding OnExpandedCommand}"
                                                           CommandParameter="{Binding .}"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                    <StackPanel Margin="0" Orientation="Horizontal" HorizontalAlignment="Stretch">
                        <Image Width="20" Height="20" Stretch="Fill" Source="{Binding Icon}" />
                        <TextBlock Text="{Binding Name}" Margin="5,0" />
                    </StackPanel>
                </StackPanel>
            </HierarchicalDataTemplate>
            <DataTemplate DataType="{x:Type files:FileObject}">
                <Border Padding="5" HorizontalAlignment="Stretch" BorderThickness="0">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsSelected}" Value="true">
                                    <Setter Property="Background" Value="DodgerBlue"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <StackPanel Margin="0" Orientation="Horizontal" HorizontalAlignment="Stretch" >
                        <Image Height="25" Stretch="Fill" Source="{Binding Icon}" />
                        <TextBlock Text="{Binding Name}" Margin="5,0" ToolTip="{Binding Path}"/>
                        <StackPanel.ContextMenu>
                            <contextMenus:FileContextMenu File="{Binding .}"/>
                        </StackPanel.ContextMenu>
                    </StackPanel>
                </Border>
            </DataTemplate>
        </TreeView.Resources>
        <TreeView.ContextMenu>
            <ContextMenu Background="WhiteSmoke">
                <MenuItem >
                    <MenuItem.Header>
                        <StackPanel Orientation="Horizontal">
                            <fa5:SvgAwesome Icon="Solid_FolderPlus" Height="14" Foreground="Green" VerticalAlignment="Center"/>
                            <TextBlock Text="Nueva carpeta" Margin="5,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </MenuItem.Header>
                </MenuItem>
            </ContextMenu>
        </TreeView.ContextMenu>
    </TreeView>
</controls:ObservableUserControl>
