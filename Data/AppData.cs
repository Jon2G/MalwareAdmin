using MalwareAdmin.Utils;
using System.Runtime.InteropServices;
using Tools = Kit.Razor.Tools;

namespace MalwareAdmin.Data
{
    public static class AppData
    {
        public static bool IsLinux => _IsLinux.Value;
        private static readonly Lazy<bool> _IsLinux = new Lazy<bool>(() => RuntimeInformation.IsOSPlatform(OSPlatform.Linux));

        public static bool IsWindows => _IsWindows.Value;
        private static readonly Lazy<bool> _IsWindows = new Lazy<bool>(() => RuntimeInformation.IsOSPlatform(OSPlatform.Windows));

        public static bool IsOSX => _IsOSX.Value;
        private static readonly Lazy<bool> _IsOSX = new Lazy<bool>(() => RuntimeInformation.IsOSPlatform(OSPlatform.OSX));


        public static DirectoryInfo SamplesFolder
        {
            get
            {
                if (Tools.Instance is not null)
                    return new DirectoryInfo($"{Tools.Instance.LibraryPath}/Samples");
                return new DirectoryInfo("F:\\source\\repos\\MalwareAdmin\\bin\\Debug\\net6.0-windows\\Samples");
            }
        }
        public static DirectoryInfo ViperFolder => new DirectoryInfo($"{Tools.Instance.LibraryPath}/Viper");

        public static string WSLViperFolder
        {
            get
            {
                var vfolder = ViperFolder;
                string rootLetter = vfolder.Root.FullName;
                string path = vfolder.FullName
                    .Replace(rootLetter, "")
                    .Replace("\\", "/");
                rootLetter = rootLetter.ToLower().Replace(":\\", "");
                string folder = $"/mnt/{rootLetter}/{path}";
                return folder;
            }
        }




        public static async Task Init()
        {
            await ViperUtils.CheckVyper();
        }
    }
}
